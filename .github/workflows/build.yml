name: ESP32 build

on:
  push:
  pull_request:

jobs:
  build:
    runs-on: ubuntu-latest
    container:
      image: espressif/idf:v5.1
    steps:
      - uses: actions/checkout@v4
- name: Build firmware
  run: |
    . /opt/esp/idf/export.sh
    idf.py --version
    rm -rf build managed_components
    idf.py set-target esp32s3
    idf.py build
